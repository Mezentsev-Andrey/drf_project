# Проект "Платформа для онлайн-обучения"

Данный проект представляет собой контейнерную версию Django-приложения “Платформа для онлайн-обучения”.

## О проекте

В мире развивается тренд на онлайн-обучение. Но для веб-разработчика важно не только обучиться, но и знать, как реализовать платформу для онлайн-обучения. Поэтому данный проект касается разработки LMS-системы, в которой каждый желающий может размещать свои полезные материалы или курсы.

## Возможности

- Создание, чтение, обновление и удаление онлайн курса в соответствии с поставленными задачами пользователей;
- Просмотр списка образовательных курсов и связанных с ними уроками с пагинацией;
- Возможность выбора пользователя, оплаченного курса и отдельно оплаченного урока;
- Можно менять порядок сортировки по дате оплаты, фильтровать по курсу или уроку, фильтровать по способу оплаты;
- Реализован CRUD для пользователей, в том числе регистрация пользователей, авторизация пользователей в проекте реализована с использование JWT-авторизации;
- Создана группа модераторов с правами работы с любыми уроками и курсами, но без возможности их удалять и создавать новые;
- Пользователи, которые не входят в группу модераторов, могут видеть, редактировать и удалять только свои курсы и уроки;
- Для сохранения уроков и курсов реализована дополнительная проверка на отсутствие в материалах ссылок на сторонние ресурсы, кроме youtube.com;
- Реализована пагинация для вывода всех уроков и курсов;
- Подключена возможность оплаты курсов через StpipeAPI;
- Добавлена асинхронная рассылка писем пользователям об обновлении материалов курса

## Технологии

- Python;
- Django (Django Rest Framework, Celery);
- PostgreSQL (БД для хранения данных);
- Docker.

## Запуск проекта

**1. Установите зависимости**:
    - `pip install -r requirements.txt`

**2. Создайте файл `.env` в корневой директории и заполните необходимые переменные окружения**:

    - POSTGRES_DB=`"имя базы данных"`;
    - POSTGRES_USER=`"пользователь базы данных"`;
    - POSTGRES_PASSWORD=`"пароль базы данных"`;
    - POSTGRES_PORT=`"порт базы данных"`;
    - POSTGRES_HOST=`"хост базы данных"`.
    
   **2.1. Настройка электронной почты с которой будут приходить уведомления согласно требуемых настроек**:
   
    - EMAIL_HOST=`"хост электронной почты"`;
    - EMAIL_PORT=`"порт электронной почты"`;
    - EMAIL_HOST_USER=`"пользователь электронной почты"`;
    - EMAIL_HOST_PASSWORD=`"сгенерированный пароль для SMTP Django"`.
            
   **2.2. Настройка Celery**:
   - CELERY_BROKER_URL=`"URL брокера Celery"`;
   - CELERY_RESULT_BACKEND=`"URL бэкенда Celery"`.

**3. Примените миграции**:
    - `python manage.py migrate`

**4. Запустите сервер**:
    - `python manage.py runserver`

**5. Запустите Celery для обработки отложенных задач**:
    - `celery -A config worker -l INFO -P eventlet`
    - `celery -A config beat -l INFO`

**6. Запуск приложения**:

- Заполнение базы данных произведено в админке. Загруженные данные представлены по адресу: materials/fixtures/all_data.json, materials/fixtures/materials_data.json; users/fixtures/users_data.json. Для их загрузки в базу данных проекта воспользуйтесь командой: `python manage.py loaddatautf8 materials_data.json`;
- Для выгрузки данных из базы данных проекта используйте команду: `python manage.py dumpdatautf8 materials --output materials/fixtures/materials_data.json` (в данном примере команды приведена выгрузка всех данных из приложения materials.);
- Создать суперпользователя кастомной командой `python manage.py csu`.

**7. Виды запросов в Postman**: 
  
   **Запросы в Postman для курса**:
   
    - POST: создание сетевого курса: http://localhost:8000/courses (заполнить тело, выбрав параметры 'raw' и 'json'; поля: name, description);
    - GET: получить список курсов: http://localhost:8000/courses/;
    - GET: получить конкретный курс: http://localhost:8000/courses/<pk курса>/;
    - PUT: обновление курса http://localhost:8000/courses/<pk курса>/ (заполнить тело, выбрав параметры 'raw' и 'json');
    - DELETE: удаление курса: http://localhost:8000/courses/<pk курса>/.
    
   **Запросы в Postman для урока**:
   
    - POST: создание урока: `http://localhost:8000/lesson/create/ (заполнить тело, выбрав параметры 'raw' и 'json', поля: name, description);
    - GET: получение списка уроков: http://localhost:8000/lesson/;
    - GET получение конкретного урока: http://localhost:8000/lesson/detail/<pk урока>/;
    - PUT: обновление урока: http://localhost:8000/lesson/update/<pk урока>;
    - DELETE: удаление урока: http://localhost:8000/lesson/delete/<pk урока>.
    
   **Запросы в Postman для подписки на курс**:
   
   - POST: создание подписки: `http://localhost:8000/subscription/create;
     
   - GET: получение списка подписок: `http://localhost:8000/subscriptions/.
    
**8. Регистрация нового пользователя**: 
   - POST: http://localhost:8000/users/user/ (заполнить тело, выбрав параметры 'raw' и 'json', поля: email, password).
    
**9. После регистрации пользователя нужно войти в приложение с помощью логина и пароля сделав соответствующий запрос**:
   - POST: http://localhost:8000/users/login/

## Документация API

Документация API доступна после запуска сервера по адресам: http://localhost:8000/redoc/ и http://localhost:8000/swagger/

## Запуск проекта с использованием Docker
  - Используйте файлы Dockerfile и docker-compose.yml. При необходимости внесите в них требуемые изменения;
  - Соберите образ с помощью команды: `docker-compose build`;
  - Запустите контейнеры с помощью команды: `docker-compose up`;
  - Управление контейнерами: Для остановки и удаления контейнеров используйте Ctrl + C в терминале, где запущен docker-compose up. Для остановки контейнеров и удаления созданных ресурсов выполните команду: `docker-compose down`;
  - Если при запуске контейнера добавить флаг -d, процесс запустится в фоновом режиме (как демон). В случае, если к команде добавить флаг --build, то перед запуском выполнится сборка. В итоге команда будет выглядеть так: `docker-compose up -d --build`.
